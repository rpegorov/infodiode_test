# Mosquitto configuration file for infodiode test project

# General settings
per_listener_settings false
allow_anonymous true
max_packet_size 100000000

# Default listener - MQTT protocol
listener 1883
protocol mqtt

# WebSocket listener (optional, for debugging)
listener 9001
protocol websockets

# Logging
log_type all
log_dest stdout
log_timestamp true
log_timestamp_format %Y-%m-%dT%H:%M:%S

# Persistence
persistence true
persistence_location /mosquitto/data/
autosave_interval 300
autosave_on_changes false

# Memory and performance
max_inflight_messages 100
max_inflight_bytes 0
max_queued_messages 10000
max_queued_bytes 0
message_size_limit 100000000

# Keep alive and timeouts
max_keepalive 65535
persistent_client_expiration 7d

# Queue settings
queue_qos0_messages true
upgrade_outgoing_qos false

# Connection settings
connection_messages true
retained_persistence true

# System topics
sys_interval 60

# Bridge configuration (uncomment if using MQTT bridge through infodiode)
# connection infodiode_bridge
# address remote-broker:1883
# topic test/# out 1
# cleansession false
# notifications false
# bridge_protocol_version mqttv311
# bridge_insecure false
# bridge_capath /mosquitto/certs/
# bridge_attempt_unsubscribe true
# bridge_max_packet_size 100000000

# Access Control (uncomment for production)
# password_file /mosquitto/config/passwords.txt
# acl_file /mosquitto/config/acl.conf

# TLS/SSL Configuration (uncomment for secure connections)
# cafile /mosquitto/certs/ca.crt
# certfile /mosquitto/certs/server.crt
# keyfile /mosquitto/certs/server.key
# require_certificate false
# tls_version tlsv1.2

# File-based authentication (create these files if needed)
# auth_plugin /mosquitto/plugins/auth-plugin.so
# auth_opt_backends files
# auth_opt_files_password_path /mosquitto/config/passwords.txt
# auth_opt_files_acl_path /mosquitto/config/acl.txt
